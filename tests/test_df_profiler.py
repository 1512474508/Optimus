from pyspark.sql.types import *
from optimus import Optimus
from optimus.helpers.json import json_enconding
from optimus.helpers.functions import deep_sort
import unittest
from pyspark.ml.linalg import Vectors, VectorUDT, DenseVector
import numpy as np
nan = np.nan
import datetime
from pyspark.sql import functions as F
from optimus.profiler.profiler import Profiler
p= Profiler()
op = Optimus(master='local')
source_df=op.create.df([('names', StringType(), True),('height(ft)', ShortType(), True),('function', StringType(), True),('rank', ByteType(), True),('age', IntegerType(), True),('weight(t)', FloatType(), True),('japanese name', ArrayType(StringType(),True), True),('last position seen', StringType(), True),('date arrival', StringType(), True),('last date seen', StringType(), True),('attributes', ArrayType(FloatType(),True), True),('Date Type', DateType(), True),('timestamp', TimestampType(), True),('Cybertronian', BooleanType(), True),('function(binary)', BinaryType(), True),('NullType', NullType(), True)], [("Optim'us", -28, 'Leader', 10, 5000000, 4.300000190734863, ['Inochi', 'Convoy'], '19.442735,-99.201111', '1980/04/10', '2016/09/10', [8.53439998626709, 4300.0], datetime.date(2016, 9, 10), datetime.datetime(2014, 6, 24, 0, 0), True, bytearray(b'Leader'), None), ('bumbl#ebéé  ', 17, 'Espionage', 7, 5000000, 2.0, ['Bumble', 'Goldback'], '10.642707,-71.612534', '1980/04/10', '2015/08/10', [5.334000110626221, 2000.0], datetime.date(2015, 8, 10), datetime.datetime(2014, 6, 24, 0, 0), True, bytearray(b'Espionage'), None), ('ironhide&', 26, 'Security', 7, 5000000, 4.0, ['Roadbuster'], '37.789563,-122.400356', '1980/04/10', '2014/07/10', [7.924799919128418, 4000.0], datetime.date(2014, 6, 24), datetime.datetime(2014, 6, 24, 0, 0), True, bytearray(b'Security'), None), ('Jazz', 13, 'First Lieutenant', 8, 5000000, 1.7999999523162842, ['Meister'], '33.670666,-117.841553', '1980/04/10', '2013/06/10', [3.962399959564209, 1800.0], datetime.date(2013, 6, 24), datetime.datetime(2014, 6, 24, 0, 0), True, bytearray(b'First Lieutenant'), None), ('Megatron', None, 'None', 10, 5000000, 5.699999809265137, ['Megatron'], None, '1980/04/10', '2012/05/10', [None, 5700.0], datetime.date(2012, 5, 10), datetime.datetime(2014, 6, 24, 0, 0), True, bytearray(b'None'), None), ('Metroplex_)^$', 300, 'Battle Station', 8, 5000000, None, ['Metroflex'], None, '1980/04/10', '2011/04/10', [91.44000244140625, None], datetime.date(2011, 4, 10), datetime.datetime(2014, 6, 24, 0, 0), True, bytearray(b'Battle Station'), None), (None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None)])
class Test_df_profiler(unittest.TestCase):
	maxDiff = None
	@staticmethod
	def test_columns_agg():
		actual_df =p.columns_agg(source_df,'*')
		actual_df =json_enconding(actual_df)
		expected_value =json_enconding({'names': {'count_uniques': 5, 'min': 'Jazz', 'max': 'ironhide&', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1}, 'height(ft)': {'count_uniques': 5, 'min': -28, 'max': 300, 'stddev': 132.66612, 'kurtosis': 0.13863, 'mean': 65.6, 'skewness': 1.4049, 'sum': 328, 'variance': 17600.3, 'zeros': 0, 'percentile': {'0.75': 26, '0.95': 300, '0.05': -28, '0.25': 13, '0.5': 17}, 'count_na': 2, 'hist': [{'count': 4.0, 'lower': -28.0, 'upper': 54.0}, {'count': 0.0, 'lower': 54.0, 'upper': 136.0}, {'count': 0.0, 'lower': 136.0, 'upper': 218.0}, {'count': 0.0, 'lower': 218.0, 'upper': 300.0}]}, 'function': {'count_uniques': 6, 'min': 'Battle Station', 'max': 'Security', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1}, 'rank': {'count_uniques': 3, 'min': 7, 'max': 10, 'stddev': 1.36626, 'kurtosis': -1.5, 'mean': 8.33333, 'skewness': 0.3818, 'sum': 50, 'variance': 1.86667, 'zeros': 0, 'percentile': {'0.75': 10, '0.95': 10, '0.05': 7, '0.25': 7, '0.5': 8}, 'count_na': 1, 'hist': [{'count': 4.0, 'lower': 7.0, 'upper': 8.5}, {'count': 0.0, 'lower': 8.5, 'upper': 10.0}]}, 'age': {'count_uniques': 1, 'min': 5000000, 'max': 5000000, 'stddev': 0.0, 'kurtosis': nan, 'mean': 5000000.0, 'skewness': nan, 'sum': 30000000, 'variance': 0.0, 'zeros': 0, 'percentile': {'0.75': 5000000, '0.95': 5000000, '0.05': 5000000, '0.25': 5000000, '0.5': 5000000}, 'count_na': 1, 'hist': [{'count': 6, 'lower': 5000000, 'upper': 5000001}]}, 'weight(t)': {'count_uniques': 5, 'min': 1.8, 'max': 5.7, 'stddev': 1.64712, 'kurtosis': -1.43641, 'mean': 3.56, 'skewness': 0.06521, 'sum': 17.8, 'variance': 2.713, 'zeros': 0, 'percentile': {'0.75': 4.300000190734863, '0.95': 5.699999809265137, '0.05': 1.7999999523162842, '0.25': 2.0, '0.5': 4.0}, 'count_na': 2, 'hist': [{'count': 1.0, 'lower': 1.8, 'upper': 2.78}, {'count': 0.0, 'lower': 2.78, 'upper': 3.75}, {'count': 2.0, 'lower': 3.75, 'upper': 4.73}, {'count': 1.0, 'lower': 4.73, 'upper': 5.7}]}, 'japanese name': {'count_uniques': 6, 'min': ['Bumble', 'Goldback'], 'max': ['Roadbuster'], 'count_na': 1}, 'last position seen': {'count_uniques': 4, 'min': '10.642707,-71.612534', 'max': '37.789563,-122.400356', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 3}, 'date arrival': {'count_uniques': 1, 'min': '1980/04/10', 'max': '1980/04/10', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1}, 'last date seen': {'count_uniques': 6, 'min': '2011/04/10', 'max': '2016/09/10', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1}, 'attributes': {'count_uniques': 6, 'min': [None, 5700.0], 'max': [91.44000244140625, None], 'count_na': 1}, 'Date Type': {'count_uniques': 6, 'min': datetime.date(2011, 4, 10), 'max': datetime.date(2016, 9, 10), 'count_na': 1}, 'timestamp': {'count_uniques': 1, 'min': datetime.datetime(2014, 6, 24, 0, 0), 'max': datetime.datetime(2014, 6, 24, 0, 0), 'count_na': 1}, 'Cybertronian': {'count_uniques': 1, 'min': 1, 'max': 1, 'count_na': 1}, 'function(binary)': {'count_uniques': 6, 'min': bytearray(b'Battle Station'), 'max': bytearray(b'Security'), 'count_na': 1}, 'NullType': {'count_uniques': 0, 'min': None, 'max': None, 'count_na': 7}})
		assert(expected_value == actual_df)
	@staticmethod
	def test_columns_stats():
		actual_df =p.columns_stats(source_df,'*')
		actual_df =json_enconding(actual_df)
		expected_value =json_enconding({'count_types': {'string': 5, 'int': 3, 'decimal': 1, 'array': 2, 'date': 2, 'boolean': 1, 'binary': 1, 'null': 1, 'numeric': 0, 'categorical': 0}, 'total_count_dtypes': 8, 'dtypes_list': ['string', 'int', 'decimal', 'array', 'date', 'boolean', 'binary', 'null'], 'columns': {'names': {'stats': {'count_uniques': 5, 'min': 'Jazz', 'max': 'ironhide&', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 71.43}, 'frequency': [{'value': "Optim'us", 'count': 1, 'percentage': 14.29}, {'value': 'bumbl#ebéé  ', 'count': 1, 'percentage': 14.29}, {'value': 'ironhide&', 'count': 1, 'percentage': 14.29}, {'value': 'Jazz', 'count': 1, 'percentage': 14.29}, {'value': 'Megatron', 'count': 1, 'percentage': 14.29}, {'value': 'Metroplex_)^$', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'names', 'column_dtype': 'string', 'dtypes_stats': {'null': 1, 'missing': 0, 'string': 6}, 'column_type': 'categorical'}, 'height(ft)': {'stats': {'count_uniques': 5, 'min': -28, 'max': 300, 'stddev': 132.66612, 'kurtosis': 0.13863, 'mean': 65.6, 'skewness': 1.4049, 'sum': 328, 'variance': 17600.3, 'zeros': 0, 'percentile': {'0.75': 26, '0.95': 300, '0.05': -28, '0.25': 13, '0.5': 17}, 'count_na': 2, 'hist': [{'count': 4.0, 'lower': -28.0, 'upper': 54.0}, {'count': 0.0, 'lower': 54.0, 'upper': 136.0}, {'count': 0.0, 'lower': 136.0, 'upper': 218.0}, {'count': 0.0, 'lower': 218.0, 'upper': 300.0}], 'range': 328, 'median': 17, 'interquartile_range': 13, 'coef_variation': 2.02235, 'mad': 9, 'p_count_na': 28.57, 'p_count_uniques': 71.43}, 'name': 'height(ft)', 'column_dtype': 'int', 'dtypes_stats': {'null': 2, 'missing': 0, 'int': 5}, 'column_type': 'numeric'}, 'function': {'stats': {'count_uniques': 6, 'min': 'Battle Station', 'max': 'Security', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 85.71}, 'frequency': [{'value': 'Leader', 'count': 1, 'percentage': 14.29}, {'value': 'Espionage', 'count': 1, 'percentage': 14.29}, {'value': 'Security', 'count': 1, 'percentage': 14.29}, {'value': 'First Lieutenant', 'count': 1, 'percentage': 14.29}, {'value': 'None', 'count': 1, 'percentage': 14.29}, {'value': 'Battle Station', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'function', 'column_dtype': 'string', 'dtypes_stats': {'null': 1, 'missing': 0, 'string': 6}, 'column_type': 'categorical'}, 'rank': {'stats': {'count_uniques': 3, 'min': 7, 'max': 10, 'stddev': 1.36626, 'kurtosis': -1.5, 'mean': 8.33333, 'skewness': 0.3818, 'sum': 50, 'variance': 1.86667, 'zeros': 0, 'percentile': {'0.75': 10, '0.95': 10, '0.05': 7, '0.25': 7, '0.5': 8}, 'count_na': 1, 'hist': [{'count': 4.0, 'lower': 7.0, 'upper': 8.5}, {'count': 0.0, 'lower': 8.5, 'upper': 10.0}], 'range': 3, 'median': 8, 'interquartile_range': 3, 'coef_variation': 0.16395, 'mad': 1, 'p_count_na': 14.29, 'p_count_uniques': 42.86}, 'name': 'rank', 'column_dtype': 'int', 'dtypes_stats': {'null': 1, 'missing': 0, 'int': 6}, 'column_type': 'numeric'}, 'age': {'stats': {'count_uniques': 1, 'min': 5000000, 'max': 5000000, 'stddev': 0.0, 'kurtosis': nan, 'mean': 5000000.0, 'skewness': nan, 'sum': 30000000, 'variance': 0.0, 'zeros': 0, 'percentile': {'0.75': 5000000, '0.95': 5000000, '0.05': 5000000, '0.25': 5000000, '0.5': 5000000}, 'count_na': 1, 'hist': [{'count': 6, 'lower': 5000000, 'upper': 5000001}], 'range': 0, 'median': 5000000, 'interquartile_range': 0, 'coef_variation': 0.0, 'mad': 0, 'p_count_na': 14.29, 'p_count_uniques': 14.29}, 'name': 'age', 'column_dtype': 'int', 'dtypes_stats': {'null': 1, 'missing': 0, 'int': 6}, 'column_type': 'numeric'}, 'weight(t)': {'stats': {'count_uniques': 5, 'min': 1.8, 'max': 5.7, 'stddev': 1.64712, 'kurtosis': -1.43641, 'mean': 3.56, 'skewness': 0.06521, 'sum': 17.8, 'variance': 2.713, 'zeros': 0, 'percentile': {'0.75': 4.300000190734863, '0.95': 5.699999809265137, '0.05': 1.7999999523162842, '0.25': 2.0, '0.5': 4.0}, 'count_na': 2, 'hist': [{'count': 1.0, 'lower': 1.8, 'upper': 2.78}, {'count': 0.0, 'lower': 2.78, 'upper': 3.75}, {'count': 2.0, 'lower': 3.75, 'upper': 4.73}, {'count': 1.0, 'lower': 4.73, 'upper': 5.7}], 'range': 3.9000000000000004, 'median': 4.0, 'interquartile_range': 2.3000001907348633, 'coef_variation': 0.46267, 'mad': 1.7, 'p_count_na': 28.57, 'p_count_uniques': 71.43}, 'name': 'weight(t)', 'column_dtype': 'decimal', 'dtypes_stats': {'null': 2, 'missing': 0, 'decimal': 5}, 'column_type': 'numeric'}, 'japanese name': {'stats': {'count_uniques': 6, 'min': ['Bumble', 'Goldback'], 'max': ['Roadbuster'], 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 85.71}, 'frequency': [{'value': '[Inochi, Convoy]', 'count': 1, 'percentage': 14.29}, {'value': '[Bumble, Goldback]', 'count': 1, 'percentage': 14.29}, {'value': '[Roadbuster]', 'count': 1, 'percentage': 14.29}, {'value': '[Meister]', 'count': 1, 'percentage': 14.29}, {'value': '[Megatron]', 'count': 1, 'percentage': 14.29}, {'value': '[Metroflex]', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'japanese name', 'column_dtype': 'array', 'dtypes_stats': {'null': 1, 'missing': 0, 'array': 6}, 'column_type': 'array'}, 'last position seen': {'stats': {'count_uniques': 4, 'min': '10.642707,-71.612534', 'max': '37.789563,-122.400356', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 3, 'p_count_na': 42.86, 'p_count_uniques': 57.14}, 'frequency': [{'value': None, 'count': 3, 'percentage': 42.86}, {'value': '19.442735,-99.201111', 'count': 1, 'percentage': 14.29}, {'value': '10.642707,-71.612534', 'count': 1, 'percentage': 14.29}, {'value': '37.789563,-122.400356', 'count': 1, 'percentage': 14.29}, {'value': '33.670666,-117.841553', 'count': 1, 'percentage': 14.29}], 'name': 'last position seen', 'column_dtype': 'string', 'dtypes_stats': {'null': 3, 'missing': 0, 'string': 4}, 'column_type': 'categorical'}, 'date arrival': {'stats': {'count_uniques': 1, 'min': '1980/04/10', 'max': '1980/04/10', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 14.29}, 'frequency': [{'value': '1980/04/10', 'count': 6, 'percentage': 85.71}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'date arrival', 'column_dtype': 'string', 'dtypes_stats': {'null': 1, 'missing': 0, 'string': 6}, 'column_type': 'categorical'}, 'last date seen': {'stats': {'count_uniques': 6, 'min': '2011/04/10', 'max': '2016/09/10', 'stddev': None, 'kurtosis': None, 'mean': None, 'skewness': None, 'sum': None, 'variance': None, 'zeros': 0, 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 85.71}, 'frequency': [{'value': '2016/09/10', 'count': 1, 'percentage': 14.29}, {'value': '2015/08/10', 'count': 1, 'percentage': 14.29}, {'value': '2014/07/10', 'count': 1, 'percentage': 14.29}, {'value': '2013/06/10', 'count': 1, 'percentage': 14.29}, {'value': '2012/05/10', 'count': 1, 'percentage': 14.29}, {'value': '2011/04/10', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'last date seen', 'column_dtype': 'string', 'dtypes_stats': {'null': 1, 'missing': 0, 'string': 6}, 'column_type': 'categorical'}, 'attributes': {'stats': {'count_uniques': 6, 'min': [None, 5700.0], 'max': [91.44000244140625, None], 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 85.71}, 'frequency': [{'value': '[8.5344, 4300.0]', 'count': 1, 'percentage': 14.29}, {'value': '[5.334, 2000.0]', 'count': 1, 'percentage': 14.29}, {'value': '[7.9248, 4000.0]', 'count': 1, 'percentage': 14.29}, {'value': '[3.9624, 1800.0]', 'count': 1, 'percentage': 14.29}, {'value': '[, 5700.0]', 'count': 1, 'percentage': 14.29}, {'value': '[91.44,]', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'attributes', 'column_dtype': 'array', 'dtypes_stats': {'null': 1, 'missing': 0, 'array': 6}, 'column_type': 'array'}, 'Date Type': {'stats': {'count_uniques': 6, 'min': datetime.date(2011, 4, 10), 'max': datetime.date(2016, 9, 10), 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 85.71}, 'frequency': [{'value': '2016-09-10', 'count': 1, 'percentage': 14.29}, {'value': '2015-08-10', 'count': 1, 'percentage': 14.29}, {'value': '2014-06-24', 'count': 1, 'percentage': 14.29}, {'value': '2013-06-24', 'count': 1, 'percentage': 14.29}, {'value': '2012-05-10', 'count': 1, 'percentage': 14.29}, {'value': '2011-04-10', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'Date Type', 'column_dtype': 'date', 'dtypes_stats': {'null': 1, 'missing': 0, 'date': 6}, 'column_type': 'date'}, 'timestamp': {'stats': {'count_uniques': 1, 'min': datetime.datetime(2014, 6, 24, 0, 0), 'max': datetime.datetime(2014, 6, 24, 0, 0), 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 14.29}, 'frequency': [{'value': datetime.datetime(2014, 6, 24, 0, 0), 'count': 6, 'percentage': 85.71}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'timestamp', 'column_dtype': 'date', 'dtypes_stats': {'null': 1, 'missing': 0, 'date': 6}, 'column_type': 'date'}, 'Cybertronian': {'stats': {'count_uniques': 1, 'min': 1, 'max': 1, 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 14.29}, 'frequency': [{'value': True, 'count': 6, 'percentage': 85.71}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'Cybertronian', 'column_dtype': 'boolean', 'dtypes_stats': {'null': 1, 'missing': 0, 'boolean': 6}, 'column_type': 'categorical'}, 'function(binary)': {'stats': {'count_uniques': 6, 'min': bytearray(b'Battle Station'), 'max': bytearray(b'Security'), 'count_na': 1, 'p_count_na': 14.29, 'p_count_uniques': 85.71}, 'frequency': [{'value': 'Leader', 'count': 1, 'percentage': 14.29}, {'value': 'Espionage', 'count': 1, 'percentage': 14.29}, {'value': 'Security', 'count': 1, 'percentage': 14.29}, {'value': 'First Lieutenant', 'count': 1, 'percentage': 14.29}, {'value': 'None', 'count': 1, 'percentage': 14.29}, {'value': 'Battle Station', 'count': 1, 'percentage': 14.29}, {'value': None, 'count': 1, 'percentage': 14.29}], 'name': 'function(binary)', 'column_dtype': 'binary', 'dtypes_stats': {'null': 1, 'missing': 0, 'binary': 6}, 'column_type': 'binary'}, 'NullType': {'stats': {'count_uniques': 0, 'min': None, 'max': None, 'count_na': 7, 'p_count_na': 100.0, 'p_count_uniques': 0.0}, 'frequency': [{'value': None, 'count': 7, 'percentage': 100.0}], 'name': 'NullType', 'column_dtype': 'null', 'dtypes_stats': {'null': 7, 'missing': 0}, 'column_type': 'null'}}})
		assert(expected_value == actual_df)
	@staticmethod
	def test_dataset():
		actual_df =p.dataset(source_df,'*')
		actual_df =json_enconding(actual_df)
		expected_value =json_enconding('{"count_types": {"string": 5, "int": 3, "decimal": 1, "array": 2, "date": 2, "boolean": 1, "binary": 1, "null": 1, "numeric": 0, "categorical": 0}, "total_count_dtypes": 8, "dtypes_list": ["string", "int", "decimal", "array", "date", "boolean", "binary", "null"], "columns": {"names": {"stats": {"count_uniques": 5, "min": "Jazz", "max": "ironhide&", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 71.43}, "frequency": [{"value": "Optim'us", "count": 1, "percentage": 14.29}, {"value": "bumbl#eb\u00e9\u00e9  ", "count": 1, "percentage": 14.29}, {"value": "ironhide&", "count": 1, "percentage": 14.29}, {"value": "Jazz", "count": 1, "percentage": 14.29}, {"value": "Megatron", "count": 1, "percentage": 14.29}, {"value": "Metroplex_)^$", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "names", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "height(ft)": {"stats": {"count_uniques": 5, "min": -28, "max": 300, "stddev": 132.66612, "kurtosis": 0.13863, "mean": 65.6, "skewness": 1.4049, "sum": 328, "variance": 17600.3, "zeros": 0, "percentile": {"0.75": 26, "0.95": 300, "0.05": -28, "0.25": 13, "0.5": 17}, "count_na": 2, "hist": [{"count": 4.0, "lower": -28.0, "upper": 54.0}, {"count": 0.0, "lower": 54.0, "upper": 136.0}, {"count": 0.0, "lower": 136.0, "upper": 218.0}, {"count": 0.0, "lower": 218.0, "upper": 300.0}], "range": 328, "median": 17, "interquartile_range": 13, "coef_variation": 2.02235, "mad": 9, "p_count_na": 28.57, "p_count_uniques": 71.43}, "name": "height(ft)", "column_dtype": "int", "dtypes_stats": {"null": 2, "missing": 0, "int": 5}, "column_type": "numeric"}, "function": {"stats": {"count_uniques": 6, "min": "Battle Station", "max": "Security", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "Leader", "count": 1, "percentage": 14.29}, {"value": "Espionage", "count": 1, "percentage": 14.29}, {"value": "Security", "count": 1, "percentage": 14.29}, {"value": "First Lieutenant", "count": 1, "percentage": 14.29}, {"value": "None", "count": 1, "percentage": 14.29}, {"value": "Battle Station", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "function", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "rank": {"stats": {"count_uniques": 3, "min": 7, "max": 10, "stddev": 1.36626, "kurtosis": -1.5, "mean": 8.33333, "skewness": 0.3818, "sum": 50, "variance": 1.86667, "zeros": 0, "percentile": {"0.75": 10, "0.95": 10, "0.05": 7, "0.25": 7, "0.5": 8}, "count_na": 1, "hist": [{"count": 4.0, "lower": 7.0, "upper": 8.5}, {"count": 0.0, "lower": 8.5, "upper": 10.0}], "range": 3, "median": 8, "interquartile_range": 3, "coef_variation": 0.16395, "mad": 1, "p_count_na": 14.29, "p_count_uniques": 42.86}, "name": "rank", "column_dtype": "int", "dtypes_stats": {"null": 1, "missing": 0, "int": 6}, "column_type": "numeric"}, "age": {"stats": {"count_uniques": 1, "min": 5000000, "max": 5000000, "stddev": 0.0, "kurtosis": null, "mean": 5000000.0, "skewness": null, "sum": 30000000, "variance": 0.0, "zeros": 0, "percentile": {"0.75": 5000000, "0.95": 5000000, "0.05": 5000000, "0.25": 5000000, "0.5": 5000000}, "count_na": 1, "hist": [{"count": 6, "lower": 5000000, "upper": 5000001}], "range": 0, "median": 5000000, "interquartile_range": 0, "coef_variation": 0.0, "mad": 0, "p_count_na": 14.29, "p_count_uniques": 14.29}, "name": "age", "column_dtype": "int", "dtypes_stats": {"null": 1, "missing": 0, "int": 6}, "column_type": "numeric"}, "weight(t)": {"stats": {"count_uniques": 5, "min": 1.8, "max": 5.7, "stddev": 1.64712, "kurtosis": -1.43641, "mean": 3.56, "skewness": 0.06521, "sum": 17.8, "variance": 2.713, "zeros": 0, "percentile": {"0.75": 4.300000190734863, "0.95": 5.699999809265137, "0.05": 1.7999999523162842, "0.25": 2.0, "0.5": 4.0}, "count_na": 2, "hist": [{"count": 1.0, "lower": 1.8, "upper": 2.78}, {"count": 0.0, "lower": 2.78, "upper": 3.75}, {"count": 2.0, "lower": 3.75, "upper": 4.73}, {"count": 1.0, "lower": 4.73, "upper": 5.7}], "range": 3.9000000000000004, "median": 4.0, "interquartile_range": 2.3000001907348633, "coef_variation": 0.46267, "mad": 1.7, "p_count_na": 28.57, "p_count_uniques": 71.43}, "name": "weight(t)", "column_dtype": "decimal", "dtypes_stats": {"null": 2, "missing": 0, "decimal": 5}, "column_type": "numeric"}, "japanese name": {"stats": {"count_uniques": 6, "min": ["Bumble", "Goldback"], "max": ["Roadbuster"], "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "[Inochi, Convoy]", "count": 1, "percentage": 14.29}, {"value": "[Bumble, Goldback]", "count": 1, "percentage": 14.29}, {"value": "[Roadbuster]", "count": 1, "percentage": 14.29}, {"value": "[Meister]", "count": 1, "percentage": 14.29}, {"value": "[Megatron]", "count": 1, "percentage": 14.29}, {"value": "[Metroflex]", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "japanese name", "column_dtype": "array", "dtypes_stats": {"null": 1, "missing": 0, "array": 6}, "column_type": "array"}, "last position seen": {"stats": {"count_uniques": 4, "min": "10.642707,-71.612534", "max": "37.789563,-122.400356", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 3, "p_count_na": 42.86, "p_count_uniques": 57.14}, "frequency": [{"value": null, "count": 3, "percentage": 42.86}, {"value": "19.442735,-99.201111", "count": 1, "percentage": 14.29}, {"value": "10.642707,-71.612534", "count": 1, "percentage": 14.29}, {"value": "37.789563,-122.400356", "count": 1, "percentage": 14.29}, {"value": "33.670666,-117.841553", "count": 1, "percentage": 14.29}], "name": "last position seen", "column_dtype": "string", "dtypes_stats": {"null": 3, "missing": 0, "string": 4}, "column_type": "categorical"}, "date arrival": {"stats": {"count_uniques": 1, "min": "1980/04/10", "max": "1980/04/10", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 14.29}, "frequency": [{"value": "1980/04/10", "count": 6, "percentage": 85.71}, {"value": null, "count": 1, "percentage": 14.29}], "name": "date arrival", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "last date seen": {"stats": {"count_uniques": 6, "min": "2011/04/10", "max": "2016/09/10", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "2016/09/10", "count": 1, "percentage": 14.29}, {"value": "2015/08/10", "count": 1, "percentage": 14.29}, {"value": "2014/07/10", "count": 1, "percentage": 14.29}, {"value": "2013/06/10", "count": 1, "percentage": 14.29}, {"value": "2012/05/10", "count": 1, "percentage": 14.29}, {"value": "2011/04/10", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "last date seen", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "attributes": {"stats": {"count_uniques": 6, "min": [null, 5700.0], "max": [91.44000244140625, null], "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "[8.5344, 4300.0]", "count": 1, "percentage": 14.29}, {"value": "[5.334, 2000.0]", "count": 1, "percentage": 14.29}, {"value": "[7.9248, 4000.0]", "count": 1, "percentage": 14.29}, {"value": "[3.9624, 1800.0]", "count": 1, "percentage": 14.29}, {"value": "[, 5700.0]", "count": 1, "percentage": 14.29}, {"value": "[91.44,]", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "attributes", "column_dtype": "array", "dtypes_stats": {"null": 1, "missing": 0, "array": 6}, "column_type": "array"}, "Date Type": {"stats": {"count_uniques": 6, "min": "2011-04-10", "max": "2016-09-10", "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "2016-09-10", "count": 1, "percentage": 14.29}, {"value": "2015-08-10", "count": 1, "percentage": 14.29}, {"value": "2014-06-24", "count": 1, "percentage": 14.29}, {"value": "2013-06-24", "count": 1, "percentage": 14.29}, {"value": "2012-05-10", "count": 1, "percentage": 14.29}, {"value": "2011-04-10", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "Date Type", "column_dtype": "date", "dtypes_stats": {"null": 1, "missing": 0, "date": 6}, "column_type": "date"}, "timestamp": {"stats": {"count_uniques": 1, "min": "2014-06-24 00:00:00", "max": "2014-06-24 00:00:00", "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 14.29}, "frequency": [{"value": "2014-06-24 00:00:00", "count": 6, "percentage": 85.71}, {"value": null, "count": 1, "percentage": 14.29}], "name": "timestamp", "column_dtype": "date", "dtypes_stats": {"null": 1, "missing": 0, "date": 6}, "column_type": "date"}, "Cybertronian": {"stats": {"count_uniques": 1, "min": 1, "max": 1, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 14.29}, "frequency": [{"value": true, "count": 6, "percentage": 85.71}, {"value": null, "count": 1, "percentage": 14.29}], "name": "Cybertronian", "column_dtype": "boolean", "dtypes_stats": {"null": 1, "missing": 0, "boolean": 6}, "column_type": "categorical"}, "function(binary)": {"stats": {"count_uniques": 6, "min": null, "max": null, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "Leader", "count": 1, "percentage": 14.29}, {"value": "Espionage", "count": 1, "percentage": 14.29}, {"value": "Security", "count": 1, "percentage": 14.29}, {"value": "First Lieutenant", "count": 1, "percentage": 14.29}, {"value": "None", "count": 1, "percentage": 14.29}, {"value": "Battle Station", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "function(binary)", "column_dtype": "binary", "dtypes_stats": {"null": 1, "missing": 0, "binary": 6}, "column_type": "binary"}, "NullType": {"stats": {"count_uniques": 0, "min": null, "max": null, "count_na": 7, "p_count_na": 100.0, "p_count_uniques": 0.0}, "frequency": [{"value": null, "count": 7, "percentage": 100.0}], "name": "NullType", "column_dtype": "null", "dtypes_stats": {"null": 7, "missing": 0}, "column_type": "null"}}, "name": null, "file_name": null, "summary": {"cols_count": 16, "rows_count": 7, "size": "44.7 MB", "sample_size": 10000, "missing_count": 26, "p_missing": 371.43}, "sample": {"columns": [{"title": "names"}, {"title": "height(ft)"}, {"title": "function"}, {"title": "rank"}, {"title": "age"}, {"title": "weight(t)"}, {"title": "japanese name"}, {"title": "last position seen"}, {"title": "date arrival"}, {"title": "last date seen"}, {"title": "attributes"}, {"title": "Date Type"}, {"title": "timestamp"}, {"title": "Cybertronian"}, {"title": "function(binary)"}, {"title": "NullType"}], "value": [["Optim'us", -28, "Leader", 10, 5000000, 4.300000190734863, ["Inochi", "Convoy"], "19.442735,-99.201111", "1980/04/10", "2016/09/10", [8.53439998626709, 4300.0], "2016-09-10", "2014-06-24 00:00:00", true, null, null], ["bumbl#eb\u00e9\u00e9  ", 17, "Espionage", 7, 5000000, 2.0, ["Bumble", "Goldback"], "10.642707,-71.612534", "1980/04/10", "2015/08/10", [5.334000110626221, 2000.0], "2015-08-10", "2014-06-24 00:00:00", true, null, null], ["ironhide&", 26, "Security", 7, 5000000, 4.0, ["Roadbuster"], "37.789563,-122.400356", "1980/04/10", "2014/07/10", [7.924799919128418, 4000.0], "2014-06-24", "2014-06-24 00:00:00", true, null, null], ["Jazz", 13, "First Lieutenant", 8, 5000000, 1.7999999523162842, ["Meister"], "33.670666,-117.841553", "1980/04/10", "2013/06/10", [3.962399959564209, 1800.0], "2013-06-24", "2014-06-24 00:00:00", true, null, null], ["Megatron", null, "None", 10, 5000000, 5.699999809265137, ["Megatron"], null, "1980/04/10", "2012/05/10", [null, 5700.0], "2012-05-10", "2014-06-24 00:00:00", true, null, null], ["Metroplex_)^$", 300, "Battle Station", 8, 5000000, null, ["Metroflex"], null, "1980/04/10", "2011/04/10", [91.44000244140625, null], "2011-04-10", "2014-06-24 00:00:00", true, null, null], [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null]]}}')
		assert(expected_value == actual_df)
	@staticmethod
	def test_dataset_mismatch():
		actual_df =p.dataset(source_df,'*',mismatch={'names': 'dd/mm/yyyy', 'height(ft)': '^([0-2][0-9]|(3)[0-1])(\\/)(((0)[0-9])|((1)[0-2]))(\\/)\\d{4}$', 'function': 'yyyy-mm-dd'})
		actual_df =json_enconding(actual_df)
		expected_value =json_enconding('{"count_types": {"string": 5, "int": 3, "decimal": 1, "array": 2, "date": 2, "boolean": 1, "binary": 1, "null": 1, "numeric": 0, "categorical": 0}, "total_count_dtypes": 8, "dtypes_list": ["string", "int", "decimal", "array", "date", "boolean", "binary", "null"], "columns": {"names": {"stats": {"count_uniques": 5, "min": "Jazz", "max": "ironhide&", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 71.43}, "frequency": [{"value": "Optim'us", "count": 1, "percentage": 14.29}, {"value": "bumbl#eb\u00e9\u00e9  ", "count": 1, "percentage": 14.29}, {"value": "ironhide&", "count": 1, "percentage": 14.29}, {"value": "Jazz", "count": 1, "percentage": 14.29}, {"value": "Megatron", "count": 1, "percentage": 14.29}, {"value": "Metroplex_)^$", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "names", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "height(ft)": {"stats": {"count_uniques": 5, "min": -28, "max": 300, "stddev": 132.66612, "kurtosis": 0.13863, "mean": 65.6, "skewness": 1.4049, "sum": 328, "variance": 17600.3, "zeros": 0, "percentile": {"0.75": 26, "0.95": 300, "0.05": -28, "0.25": 13, "0.5": 17}, "count_na": 2, "hist": [{"count": 4.0, "lower": -28.0, "upper": 54.0}, {"count": 0.0, "lower": 54.0, "upper": 136.0}, {"count": 0.0, "lower": 136.0, "upper": 218.0}, {"count": 0.0, "lower": 218.0, "upper": 300.0}], "range": 328, "median": 17, "interquartile_range": 13, "coef_variation": 2.02235, "mad": 9, "p_count_na": 28.57, "p_count_uniques": 71.43}, "name": "height(ft)", "column_dtype": "int", "dtypes_stats": {"null": 2, "missing": 0, "int": 5}, "column_type": "numeric"}, "function": {"stats": {"count_uniques": 6, "min": "Battle Station", "max": "Security", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "Leader", "count": 1, "percentage": 14.29}, {"value": "Espionage", "count": 1, "percentage": 14.29}, {"value": "Security", "count": 1, "percentage": 14.29}, {"value": "First Lieutenant", "count": 1, "percentage": 14.29}, {"value": "None", "count": 1, "percentage": 14.29}, {"value": "Battle Station", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "function", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "rank": {"stats": {"count_uniques": 3, "min": 7, "max": 10, "stddev": 1.36626, "kurtosis": -1.5, "mean": 8.33333, "skewness": 0.3818, "sum": 50, "variance": 1.86667, "zeros": 0, "percentile": {"0.75": 10, "0.95": 10, "0.05": 7, "0.25": 7, "0.5": 8}, "count_na": 1, "hist": [{"count": 4.0, "lower": 7.0, "upper": 8.5}, {"count": 0.0, "lower": 8.5, "upper": 10.0}], "range": 3, "median": 8, "interquartile_range": 3, "coef_variation": 0.16395, "mad": 1, "p_count_na": 14.29, "p_count_uniques": 42.86}, "name": "rank", "column_dtype": "int", "dtypes_stats": {"null": 1, "missing": 0, "int": 6}, "column_type": "numeric"}, "age": {"stats": {"count_uniques": 1, "min": 5000000, "max": 5000000, "stddev": 0.0, "kurtosis": null, "mean": 5000000.0, "skewness": null, "sum": 30000000, "variance": 0.0, "zeros": 0, "percentile": {"0.75": 5000000, "0.95": 5000000, "0.05": 5000000, "0.25": 5000000, "0.5": 5000000}, "count_na": 1, "hist": [{"count": 6, "lower": 5000000, "upper": 5000001}], "range": 0, "median": 5000000, "interquartile_range": 0, "coef_variation": 0.0, "mad": 0, "p_count_na": 14.29, "p_count_uniques": 14.29}, "name": "age", "column_dtype": "int", "dtypes_stats": {"null": 1, "missing": 0, "int": 6}, "column_type": "numeric"}, "weight(t)": {"stats": {"count_uniques": 5, "min": 1.8, "max": 5.7, "stddev": 1.64712, "kurtosis": -1.43641, "mean": 3.56, "skewness": 0.06521, "sum": 17.8, "variance": 2.713, "zeros": 0, "percentile": {"0.75": 4.300000190734863, "0.95": 5.699999809265137, "0.05": 1.7999999523162842, "0.25": 2.0, "0.5": 4.0}, "count_na": 2, "hist": [{"count": 1.0, "lower": 1.8, "upper": 2.78}, {"count": 0.0, "lower": 2.78, "upper": 3.75}, {"count": 2.0, "lower": 3.75, "upper": 4.73}, {"count": 1.0, "lower": 4.73, "upper": 5.7}], "range": 3.9000000000000004, "median": 4.0, "interquartile_range": 2.3000001907348633, "coef_variation": 0.46267, "mad": 1.7, "p_count_na": 28.57, "p_count_uniques": 71.43}, "name": "weight(t)", "column_dtype": "decimal", "dtypes_stats": {"null": 2, "missing": 0, "decimal": 5}, "column_type": "numeric"}, "japanese name": {"stats": {"count_uniques": 6, "min": ["Bumble", "Goldback"], "max": ["Roadbuster"], "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "[Inochi, Convoy]", "count": 1, "percentage": 14.29}, {"value": "[Bumble, Goldback]", "count": 1, "percentage": 14.29}, {"value": "[Roadbuster]", "count": 1, "percentage": 14.29}, {"value": "[Meister]", "count": 1, "percentage": 14.29}, {"value": "[Megatron]", "count": 1, "percentage": 14.29}, {"value": "[Metroflex]", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "japanese name", "column_dtype": "array", "dtypes_stats": {"null": 1, "missing": 0, "array": 6}, "column_type": "array"}, "last position seen": {"stats": {"count_uniques": 4, "min": "10.642707,-71.612534", "max": "37.789563,-122.400356", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 3, "p_count_na": 42.86, "p_count_uniques": 57.14}, "frequency": [{"value": null, "count": 3, "percentage": 42.86}, {"value": "19.442735,-99.201111", "count": 1, "percentage": 14.29}, {"value": "10.642707,-71.612534", "count": 1, "percentage": 14.29}, {"value": "37.789563,-122.400356", "count": 1, "percentage": 14.29}, {"value": "33.670666,-117.841553", "count": 1, "percentage": 14.29}], "name": "last position seen", "column_dtype": "string", "dtypes_stats": {"null": 3, "missing": 0, "string": 4}, "column_type": "categorical"}, "date arrival": {"stats": {"count_uniques": 1, "min": "1980/04/10", "max": "1980/04/10", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 14.29}, "frequency": [{"value": "1980/04/10", "count": 6, "percentage": 85.71}, {"value": null, "count": 1, "percentage": 14.29}], "name": "date arrival", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "last date seen": {"stats": {"count_uniques": 6, "min": "2011/04/10", "max": "2016/09/10", "stddev": null, "kurtosis": null, "mean": null, "skewness": null, "sum": null, "variance": null, "zeros": 0, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "2016/09/10", "count": 1, "percentage": 14.29}, {"value": "2015/08/10", "count": 1, "percentage": 14.29}, {"value": "2014/07/10", "count": 1, "percentage": 14.29}, {"value": "2013/06/10", "count": 1, "percentage": 14.29}, {"value": "2012/05/10", "count": 1, "percentage": 14.29}, {"value": "2011/04/10", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "last date seen", "column_dtype": "string", "dtypes_stats": {"null": 1, "missing": 0, "string": 6}, "column_type": "categorical"}, "attributes": {"stats": {"count_uniques": 6, "min": [null, 5700.0], "max": [91.44000244140625, null], "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "[8.5344, 4300.0]", "count": 1, "percentage": 14.29}, {"value": "[5.334, 2000.0]", "count": 1, "percentage": 14.29}, {"value": "[7.9248, 4000.0]", "count": 1, "percentage": 14.29}, {"value": "[3.9624, 1800.0]", "count": 1, "percentage": 14.29}, {"value": "[, 5700.0]", "count": 1, "percentage": 14.29}, {"value": "[91.44,]", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "attributes", "column_dtype": "array", "dtypes_stats": {"null": 1, "missing": 0, "array": 6}, "column_type": "array"}, "Date Type": {"stats": {"count_uniques": 6, "min": "2011-04-10", "max": "2016-09-10", "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "2016-09-10", "count": 1, "percentage": 14.29}, {"value": "2015-08-10", "count": 1, "percentage": 14.29}, {"value": "2014-06-24", "count": 1, "percentage": 14.29}, {"value": "2013-06-24", "count": 1, "percentage": 14.29}, {"value": "2012-05-10", "count": 1, "percentage": 14.29}, {"value": "2011-04-10", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "Date Type", "column_dtype": "date", "dtypes_stats": {"null": 1, "missing": 0, "date": 6}, "column_type": "date"}, "timestamp": {"stats": {"count_uniques": 1, "min": "2014-06-24 00:00:00", "max": "2014-06-24 00:00:00", "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 14.29}, "frequency": [{"value": "2014-06-24 00:00:00", "count": 6, "percentage": 85.71}, {"value": null, "count": 1, "percentage": 14.29}], "name": "timestamp", "column_dtype": "date", "dtypes_stats": {"null": 1, "missing": 0, "date": 6}, "column_type": "date"}, "Cybertronian": {"stats": {"count_uniques": 1, "min": 1, "max": 1, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 14.29}, "frequency": [{"value": true, "count": 6, "percentage": 85.71}, {"value": null, "count": 1, "percentage": 14.29}], "name": "Cybertronian", "column_dtype": "boolean", "dtypes_stats": {"null": 1, "missing": 0, "boolean": 6}, "column_type": "categorical"}, "function(binary)": {"stats": {"count_uniques": 6, "min": null, "max": null, "count_na": 1, "p_count_na": 14.29, "p_count_uniques": 85.71}, "frequency": [{"value": "Leader", "count": 1, "percentage": 14.29}, {"value": "Espionage", "count": 1, "percentage": 14.29}, {"value": "Security", "count": 1, "percentage": 14.29}, {"value": "First Lieutenant", "count": 1, "percentage": 14.29}, {"value": "None", "count": 1, "percentage": 14.29}, {"value": "Battle Station", "count": 1, "percentage": 14.29}, {"value": null, "count": 1, "percentage": 14.29}], "name": "function(binary)", "column_dtype": "binary", "dtypes_stats": {"null": 1, "missing": 0, "binary": 6}, "column_type": "binary"}, "NullType": {"stats": {"count_uniques": 0, "min": null, "max": null, "count_na": 7, "p_count_na": 100.0, "p_count_uniques": 0.0}, "frequency": [{"value": null, "count": 7, "percentage": 100.0}], "name": "NullType", "column_dtype": "null", "dtypes_stats": {"null": 7, "missing": 0}, "column_type": "null"}}, "name": null, "file_name": null, "summary": {"cols_count": 16, "rows_count": 7, "size": "47.6 MB", "sample_size": 10000, "missing_count": 26, "p_missing": 371.43}, "sample": {"columns": [{"title": "names"}, {"title": "height(ft)"}, {"title": "function"}, {"title": "rank"}, {"title": "age"}, {"title": "weight(t)"}, {"title": "japanese name"}, {"title": "last position seen"}, {"title": "date arrival"}, {"title": "last date seen"}, {"title": "attributes"}, {"title": "Date Type"}, {"title": "timestamp"}, {"title": "Cybertronian"}, {"title": "function(binary)"}, {"title": "NullType"}], "value": [["Optim'us", -28, "Leader", 10, 5000000, 4.300000190734863, ["Inochi", "Convoy"], "19.442735,-99.201111", "1980/04/10", "2016/09/10", [8.53439998626709, 4300.0], "2016-09-10", "2014-06-24 00:00:00", true, null, null], ["bumbl#eb\u00e9\u00e9  ", 17, "Espionage", 7, 5000000, 2.0, ["Bumble", "Goldback"], "10.642707,-71.612534", "1980/04/10", "2015/08/10", [5.334000110626221, 2000.0], "2015-08-10", "2014-06-24 00:00:00", true, null, null], ["ironhide&", 26, "Security", 7, 5000000, 4.0, ["Roadbuster"], "37.789563,-122.400356", "1980/04/10", "2014/07/10", [7.924799919128418, 4000.0], "2014-06-24", "2014-06-24 00:00:00", true, null, null], ["Jazz", 13, "First Lieutenant", 8, 5000000, 1.7999999523162842, ["Meister"], "33.670666,-117.841553", "1980/04/10", "2013/06/10", [3.962399959564209, 1800.0], "2013-06-24", "2014-06-24 00:00:00", true, null, null], ["Megatron", null, "None", 10, 5000000, 5.699999809265137, ["Megatron"], null, "1980/04/10", "2012/05/10", [null, 5700.0], "2012-05-10", "2014-06-24 00:00:00", true, null, null], ["Metroplex_)^$", 300, "Battle Station", 8, 5000000, null, ["Metroflex"], null, "1980/04/10", "2011/04/10", [91.44000244140625, null], "2011-04-10", "2014-06-24 00:00:00", true, null, null], [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null]]}}')
		assert(expected_value == actual_df)
